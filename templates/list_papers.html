<!-- templates/list_papers.html -->
{% extends "base.html" %}
{% block content %}
<h1 class="mb-3">論文一覧</h1>

<form method="get" class="row g-2 mb-3">
  <div class="col-md-4">
    <input
      type="text"
      name="q"
      class="form-control"
      placeholder="タイトル・著者・要約・キーワードで検索"
      value="{{ q or '' }}"
    >
  </div>
  <div class="col-md-3">
    <select name="category" class="form-select">
      <option value="">分野指定なし</option>
      <option value="飛行" {% if selected_category == "飛行" %}selected{% endif %}>飛行</option>
      <option value="匂い" {% if selected_category == "匂い" %}selected{% endif %}>匂い</option>
      <option value="ナビゲーション" {% if selected_category == "ナビゲーション" %}selected{% endif %}>ナビゲーション</option>
      <option value="その他" {% if selected_category == "その他" %}selected{% endif %}>その他</option>
    </select>
  </div>
  <div class="col-md-3">
    <button type="submit" class="btn btn-primary">検索</button>
    <a href="{{ url_for('list_papers') }}" class="btn btn-secondary ms-1">クリア</a>
  </div>
</form>

{% if papers|length == 0 %}
  <p>条件に一致する論文がありません。</p>
{% else %}
  <table class="table table-striped table-hover bg-white">
    <thead>
      <tr>
        <th>ID</th>
        <th>タイトル</th>
        <th>著者</th>
        <th>年</th>
        <th>分野</th>
        <th>キーワード</th>
        <th>一言要約</th>
        <th>登録日</th>
      </tr>
    </thead>
    <tbody>
      {% for p in papers %}
      <tr>
        <td>{{ p["id"] }}</td>
        <td>
          <a href="{{ url_for('paper_detail', paper_id=p['id']) }}">
            {{ p["title"] }}
          </a>
        </td>
        <td>{{ p["authors"] }}</td>
        <td>{{ p["year"] or "-" }}</td>
        <td>{{ p["category"] or "" }}</td>
        <td>{{ p["keywords"] or "" }}</td>
        <td>{{ p["summary_short"] }}</td>
        <td>{{ p["created_at"] }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% endif %}
{% endblock %}
